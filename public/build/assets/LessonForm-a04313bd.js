import{W as y,r as f,j as l,e as N}from"./app-fed2a0d1.js";import{M as C}from"./Modal-7d9c6350.js";import{I as a}from"./Input-e0a25325.js";import{B as x}from"./Button-f318903a.js";import{T as E}from"./Textarea-bc40bf29.js";import{A as S}from"./AudioUploader-bb2266a4.js";const M=({showForm:c,setShowForm:u,lesson:i,latestLessonNumber:n,courseId:m,moduleId:p})=>{const{data:e,setData:t,errors:o,post:d,clearErrors:b,processing:j}=y(i??{course_id:m,module_id:p,number:n+1});console.log(e),f.useEffect(()=>{i!=null&&i.title&&t(i)},[i]);const v=r=>{r.preventDefault();let s=i?route("lessons.update",i.id):route("lessons.store");d(s,{preserveScroll:!0,onSuccess:()=>{u(!1),t({course_id:m,module_id:p,number:n+1})}})},g=r=>{console.log(r),t(s=>({...s,file:r.path,playable_file:r.playable_file}))};f.useEffect(()=>{c||b(),i||t(r=>({...r,title:"",description:"",number:n+1,video:""}))},[c]);const h=async r=>{try{const s=await N.post(route("podcast.remove"),{path:r});t(_=>({..._,file:null,playable_file:null,time:0}))}catch(s){console.log(s)}};return l.jsx(C,{show:c,onClose:()=>u(!1),children:l.jsxs("form",{onSubmit:v,className:"flex flex-col gap-3",children:[l.jsx(a,{value:(e==null?void 0:e.title)??"",onChange:r=>t("title",r.target.value),label:"Title",error:o.title}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("p",{className:"font-medium",children:"Type"}),l.jsx("div",{className:"flex items-center gap-3",children:["video","podcast"].map(r=>l.jsxs("div",{onClick:()=>t(s=>({...s,type:r,file:null})),className:`w-full cursor-pointer border transition-all text-center p-2 ${r===e.type?"border border-primary":""}`,children:[" ",r," "]},r))}),l.jsx("p",{className:"text-red-500 text-sm",children:o.type??""})]}),(e==null?void 0:e.type)==="video"?l.jsx(a,{value:(e==null?void 0:e.file)??"",onChange:r=>t("file",r.target.value),label:"Vimeo ID",error:o.file}):null,!e.playable_file&&e.type==="podcast"&&l.jsx(S,{handleUploadSuccess:g}),l.jsx("p",{className:"text-red-500 text-sm",children:(e.type==="podcast"&&o.file)??""}),e.playable_file&&l.jsxs(l.Fragment,{children:[l.jsx("audio",{className:"w-full",controls:!0,children:l.jsx("source",{src:e.playable_file,type:"audio/mp3"})}),l.jsx(x,{onClick:()=>h(e.file),className:"bg-red-600 w-[200px]",children:"Remove"})]}),l.jsx(a,{type:"number",value:(e==null?void 0:e.number)??"",onChange:r=>t("number",r.target.value),label:"Number",error:o.number}),l.jsx(a,{value:(e==null?void 0:e.number_as_text)??"",onChange:r=>t("number_as_text",r.target.value),label:"Number as text",error:o.number_as_text}),l.jsx(E,{error:o.description,rows:4,value:(e==null?void 0:e.description)??"",label:"Description",onChange:r=>t("description",r.target.value)}),l.jsx(x,{loading:j,type:"submit",children:"Submit"})]})})};export{M as default};

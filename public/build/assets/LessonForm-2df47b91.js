import{W as y,r as x,j as r,M as N,B as d,i as C}from"./app-bf4b4a66.js";import{I as o}from"./Input-66bf8bd1.js";import{T as E}from"./Textarea-b6eafe3f.js";import{A as S}from"./AudioUploader-e9b4f17b.js";const A=({showForm:c,setShowForm:u,lesson:s,latestLessonNumber:n,courseId:p,moduleId:m})=>{const{data:e,setData:t,errors:a,post:f,clearErrors:b,processing:j}=y(s??{course_id:p,module_id:m,number:n+1});console.log(e),x.useEffect(()=>{s!=null&&s.title&&t(s)},[s]);const v=l=>{l.preventDefault();let i=s?route("lessons.update",s.id):route("lessons.store");f(i,{preserveScroll:!0,onSuccess:()=>{u(!1),t({course_id:p,module_id:m,number:n+1})}})},g=l=>{console.log(l),t(i=>({...i,file:l.path,playable_file:l.playable_file}))};x.useEffect(()=>{c||b(),s||t(l=>({...l,title:"",description:"",number:n+1,video:""}))},[c]);const h=async l=>{try{const i=await C.post(route("podcast.remove"),{path:l});t(_=>({..._,file:null,playable_file:null,time:0}))}catch(i){console.log(i)}};return r.jsx(N,{show:c,onClose:()=>u(!1),children:r.jsxs("form",{onSubmit:v,className:"flex flex-col gap-3",children:[r.jsx(o,{value:(e==null?void 0:e.title)??"",onChange:l=>t("title",l.target.value),label:"Title",error:a.title}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("p",{className:"font-medium",children:"Type"}),r.jsx("div",{className:"flex items-center gap-3",children:["video","podcast"].map(l=>r.jsxs("div",{onClick:()=>t(i=>({...i,type:l,file:null})),className:`w-full cursor-pointer border transition-all text-center p-2 ${l===e.type?"border border-primary":""}`,children:[" ",l," "]},l))}),r.jsx("p",{className:"text-red-500 text-sm",children:a.type??""})]}),(e==null?void 0:e.type)==="video"?r.jsx(o,{value:(e==null?void 0:e.file)??"",onChange:l=>t("file",l.target.value),label:"Vimeo ID",error:a.file}):null,!e.playable_file&&e.type==="podcast"&&r.jsx(S,{handleUploadSuccess:g}),r.jsx("p",{className:"text-red-500 text-sm",children:(e.type==="podcast"&&a.file)??""}),e.playable_file&&r.jsxs(r.Fragment,{children:[r.jsx("audio",{className:"w-full",controls:!0,children:r.jsx("source",{src:e.playable_file,type:"audio/mp3"})}),r.jsx(d,{onClick:()=>h(e.file),className:"bg-red-600 w-[200px]",children:"Remove"})]}),r.jsx(o,{type:"number",value:(e==null?void 0:e.number)??"",onChange:l=>t("number",l.target.value),label:"Number",error:a.number}),r.jsx(o,{value:(e==null?void 0:e.number_as_text)??"",onChange:l=>t("number_as_text",l.target.value),label:"Number as text",error:a.number_as_text}),r.jsx(E,{error:a.description,rows:4,value:(e==null?void 0:e.description)??"",label:"Description",onChange:l=>t("description",l.target.value)}),r.jsx(d,{loading:j,type:"submit",children:"Submit"})]})})};export{A as default};

import{g as q,q as D,r as j,j as E}from"./app-376c3cd3.js";var I={exports:{}};(function(R){(function(){var C=function(A){if(!(this instanceof C))return new C(A);if(this.version=1,this.support=typeof File<"u"&&typeof Blob<"u"&&typeof FileList<"u"&&(!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||!1),!this.support)return!1;var a=this;a.files=[],a.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,fileParameterName:"file",chunkNumberParameterName:"resumableChunkNumber",chunkSizeParameterName:"resumableChunkSize",currentChunkSizeParameterName:"resumableCurrentChunkSize",totalSizeParameterName:"resumableTotalSize",typeParameterName:"resumableType",identifierParameterName:"resumableIdentifier",fileNameParameterName:"resumableFilename",relativePathParameterName:"resumableRelativePath",totalChunksParameterName:"resumableTotalChunks",throttleProgressCallbacks:.5,query:{},headers:{},preprocess:null,method:"multipart",uploadMethod:"POST",testMethod:"GET",prioritizeFirstAndLastChunk:!1,target:"/",testTarget:null,parameterNamespace:"",testChunks:!0,generateUniqueIdentifier:null,getTarget:null,maxChunkRetries:100,chunkRetryInterval:void 0,permanentErrors:[400,404,415,500,501],maxFiles:void 0,withCredentials:!1,xhrTimeout:0,clearInput:!0,chunkFormat:"blob",setChunkTypeFromFile:!1,maxFilesErrorCallback:function(t,n){var i=a.getOpt("maxFiles");alert("Please upload no more than "+i+" file"+(i===1?"":"s")+" at a time.")},minFileSize:1,minFileSizeErrorCallback:function(t,n){alert(t.fileName||t.name+" is too small, please upload files larger than "+l.formatSize(a.getOpt("minFileSize"))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(t,n){alert(t.fileName||t.name+" is too large, please upload files less than "+l.formatSize(a.getOpt("maxFileSize"))+".")},fileType:[],fileTypeErrorCallback:function(t,n){alert(t.fileName||t.name+" has type not allowed, please upload files of type "+a.getOpt("fileType")+".")}},a.opts=A||{},a.getOpt=function(t){var n=this;if(t instanceof Array){var i={};return l.each(t,function(r){i[r]=n.getOpt(r)}),i}if(n instanceof w){if(typeof n.opts[t]<"u")return n.opts[t];n=n.fileObj}if(n instanceof g){if(typeof n.opts[t]<"u")return n.opts[t];n=n.resumableObj}if(n instanceof C)return typeof n.opts[t]<"u"?n.opts[t]:n.defaults[t]},a.events=[],a.on=function(t,n){a.events.push(t.toLowerCase(),n)},a.fire=function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);for(var i=t[0].toLowerCase(),n=0;n<=a.events.length;n+=2)a.events[n]==i&&a.events[n+1].apply(a,t.slice(1)),a.events[n]=="catchall"&&a.events[n+1].apply(null,t);i=="fileerror"&&a.fire("error",t[2],t[1]),i=="fileprogress"&&a.fire("progress")};var l={stopEvent:function(t){t.stopPropagation(),t.preventDefault()},each:function(t,n){if(typeof t.length<"u"){for(var i=0;i<t.length;i++)if(n(t[i])===!1)return}else for(i in t)if(n(i,t[i])===!1)return},generateUniqueIdentifier:function(t,n){var i=a.getOpt("generateUniqueIdentifier");if(typeof i=="function")return i(t,n);var r=t.webkitRelativePath||t.fileName||t.name,e=t.size;return e+"-"+r.replace(/[^0-9a-zA-Z_-]/img,"")},contains:function(t,n){var i=!1;return l.each(t,function(r){return r==n?(i=!0,!1):!0}),i},formatSize:function(t){return t<1024?t+" bytes":t<1024*1024?(t/1024).toFixed(0)+" KB":t<1024*1024*1024?(t/1024/1024).toFixed(1)+" MB":(t/1024/1024/1024).toFixed(1)+" GB"},getTarget:function(t,n){var i=a.getOpt("target");if(t==="test"&&a.getOpt("testTarget")&&(i=a.getOpt("testTarget")==="/"?a.getOpt("target"):a.getOpt("testTarget")),typeof i=="function")return i(n);var r=i.indexOf("?")<0?"?":"&",e=n.join("&");return i+r+e}},S=function(t){l.stopEvent(t),t.dataTransfer&&t.dataTransfer.items?O(t.dataTransfer.items,t):t.dataTransfer&&t.dataTransfer.files&&O(t.dataTransfer.files,t)},v=function(t){t.preventDefault()};function N(t,n,i,r){var e;if(t.isFile)return t.file(function(f){f.relativePath=n+f.name,i.push(f),r()});if(t.isDirectory?e=t:t instanceof File&&i.push(t),typeof t.webkitGetAsEntry=="function"&&(e=t.webkitGetAsEntry()),e&&e.isDirectory)return U(e,n+e.name+"/",i,r);typeof t.getAsFile=="function"&&(t=t.getAsFile(),t instanceof File&&(t.relativePath=n+t.name,i.push(t))),r()}function P(t,n){if(!t||t.length===0)return n();t[0](function(){P(t.slice(1),n)})}function U(t,n,i,r){var e=t.createReader();e.readEntries(function(f){if(!f.length)return r();P(f.map(function(s){return N.bind(null,s,n,i)}),r)})}function O(t,n){if(t.length){a.fire("beforeAdd");var i=[];P(Array.prototype.map.call(t,function(r){return N.bind(null,r,"",i)}),function(){i.length&&x(i,n)})}}var x=function(t,n){var i=0,r=a.getOpt(["maxFiles","minFileSize","maxFileSize","maxFilesErrorCallback","minFileSizeErrorCallback","maxFileSizeErrorCallback","fileType","fileTypeErrorCallback"]);if(typeof r.maxFiles<"u"&&r.maxFiles<t.length+a.files.length)if(r.maxFiles===1&&a.files.length===1&&t.length===1)a.removeFile(a.files[0]);else return r.maxFilesErrorCallback(t,i++),!1;var e=[],f=[],s=t.length,u=function(){if(!--s){if(!e.length&&!f.length)return;window.setTimeout(function(){a.fire("filesAdded",e,f)},0)}};l.each(t,function(o){var d=o.name;if(r.fileType.length>0){var y=!1;for(var h in r.fileType){var c="."+r.fileType[h];if(d.toLowerCase().indexOf(c.toLowerCase(),d.length-c.length)!==-1){y=!0;break}}if(!y)return r.fileTypeErrorCallback(o,i++),!1}if(typeof r.minFileSize<"u"&&o.size<r.minFileSize)return r.minFileSizeErrorCallback(o,i++),!1;if(typeof r.maxFileSize<"u"&&o.size>r.maxFileSize)return r.maxFileSizeErrorCallback(o,i++),!1;function F(k){a.getFromUniqueIdentifier(k)?f.push(o):function(){o.uniqueIdentifier=k;var z=new g(a,o,k);a.files.push(z),e.push(z),z.container=typeof n<"u"?n.srcElement:null,window.setTimeout(function(){a.fire("fileAdded",z,n)},0)}(),u()}var b=l.generateUniqueIdentifier(o,n);b&&typeof b.then=="function"?b.then(function(k){F(k)},function(){u()}):F(b)})};function g(t,n,i){var r=this;r.opts={},r.getOpt=t.getOpt,r._prevProgress=0,r.resumableObj=t,r.file=n,r.fileName=n.fileName||n.name,r.size=n.size,r.relativePath=n.relativePath||n.webkitRelativePath||r.fileName,r.uniqueIdentifier=i,r._pause=!1,r.container="";var e=i!==void 0,f=function(s,u){switch(s){case"progress":r.resumableObj.fire("fileProgress",r,u);break;case"error":r.abort(),e=!0,r.chunks=[],r.resumableObj.fire("fileError",r,u);break;case"success":if(e)return;r.resumableObj.fire("fileProgress",r),r.isComplete()&&r.resumableObj.fire("fileSuccess",r,u);break;case"retry":r.resumableObj.fire("fileRetry",r);break}};return r.chunks=[],r.abort=function(){var s=0;l.each(r.chunks,function(u){u.status()=="uploading"&&(u.abort(),s++)}),s>0&&r.resumableObj.fire("fileProgress",r)},r.cancel=function(){var s=r.chunks;r.chunks=[],l.each(s,function(u){u.status()=="uploading"&&(u.abort(),r.resumableObj.uploadNextChunk())}),r.resumableObj.removeFile(r),r.resumableObj.fire("fileProgress",r)},r.retry=function(){r.bootstrap();var s=!1;r.resumableObj.on("chunkingComplete",function(){s||r.resumableObj.upload(),s=!0})},r.bootstrap=function(){r.abort(),e=!1,r.chunks=[],r._prevProgress=0;for(var s=r.getOpt("forceChunkSize")?Math.ceil:Math.floor,u=Math.max(s(r.file.size/r.getOpt("chunkSize")),1),o=0;o<u;o++)(function(d){window.setTimeout(function(){r.chunks.push(new w(r.resumableObj,r,d,f)),r.resumableObj.fire("chunkingProgress",r,d/u)},0)})(o);window.setTimeout(function(){r.resumableObj.fire("chunkingComplete",r)},0)},r.progress=function(){if(e)return 1;var s=0,u=!1;return l.each(r.chunks,function(o){o.status()=="error"&&(u=!0),s+=o.progress(!0)}),s=u||s>.99999?1:s,s=Math.max(r._prevProgress,s),r._prevProgress=s,s},r.isUploading=function(){var s=!1;return l.each(r.chunks,function(u){if(u.status()=="uploading")return s=!0,!1}),s},r.isComplete=function(){var s=!1;return l.each(r.chunks,function(u){var o=u.status();if(o=="pending"||o=="uploading"||u.preprocessState===1)return s=!0,!1}),!s},r.pause=function(s){typeof s>"u"?r._pause=!r._pause:r._pause=s},r.isPaused=function(){return r._pause},r.resumableObj.fire("chunkingStart",r),r.bootstrap(),this}function w(t,n,i,r){var e=this;e.opts={},e.getOpt=t.getOpt,e.resumableObj=t,e.fileObj=n,e.fileObjSize=n.size,e.fileObjType=n.file.type,e.offset=i,e.callback=r,e.lastProgressCallback=new Date,e.tested=!1,e.retries=0,e.pendingRetry=!1,e.preprocessState=0;var f=e.getOpt("chunkSize");return e.loaded=0,e.startByte=e.offset*f,e.endByte=Math.min(e.fileObjSize,(e.offset+1)*f),e.fileObjSize-e.endByte<f&&!e.getOpt("forceChunkSize")&&(e.endByte=e.fileObjSize),e.xhr=null,e.test=function(){e.xhr=new XMLHttpRequest;var s=function(h){e.tested=!0;var c=e.status();c=="success"?(e.callback(c,e.message()),e.resumableObj.uploadNextChunk()):e.send()};e.xhr.addEventListener("load",s,!1),e.xhr.addEventListener("error",s,!1),e.xhr.addEventListener("timeout",s,!1);var u=[],o=e.getOpt("parameterNamespace"),d=e.getOpt("query");typeof d=="function"&&(d=d(e.fileObj,e)),l.each(d,function(h,c){u.push([encodeURIComponent(o+h),encodeURIComponent(c)].join("="))}),u=u.concat([["chunkNumberParameterName",e.offset+1],["chunkSizeParameterName",e.getOpt("chunkSize")],["currentChunkSizeParameterName",e.endByte-e.startByte],["totalSizeParameterName",e.fileObjSize],["typeParameterName",e.fileObjType],["identifierParameterName",e.fileObj.uniqueIdentifier],["fileNameParameterName",e.fileObj.fileName],["relativePathParameterName",e.fileObj.relativePath],["totalChunksParameterName",e.fileObj.chunks.length]].filter(function(h){return e.getOpt(h[0])}).map(function(h){return[o+e.getOpt(h[0]),encodeURIComponent(h[1])].join("=")})),e.xhr.open(e.getOpt("testMethod"),l.getTarget("test",u)),e.xhr.timeout=e.getOpt("xhrTimeout"),e.xhr.withCredentials=e.getOpt("withCredentials");var y=e.getOpt("headers");typeof y=="function"&&(y=y(e.fileObj,e)),l.each(y,function(h,c){e.xhr.setRequestHeader(h,c)}),e.xhr.send(null)},e.preprocessFinished=function(){e.preprocessState=2,e.send()},e.send=function(){var s=e.getOpt("preprocess");if(typeof s=="function")switch(e.preprocessState){case 0:e.preprocessState=1,s(e);return;case 1:return}if(e.getOpt("testChunks")&&!e.tested){e.test();return}e.xhr=new XMLHttpRequest,e.xhr.upload.addEventListener("progress",function(p){new Date-e.lastProgressCallback>e.getOpt("throttleProgressCallbacks")*1e3&&(e.callback("progress"),e.lastProgressCallback=new Date),e.loaded=p.loaded||0},!1),e.loaded=0,e.pendingRetry=!1,e.callback("progress");var u=function(p){var m=e.status();if(m=="success"||m=="error")e.callback(m,e.message()),e.resumableObj.uploadNextChunk();else{e.callback("retry",e.message()),e.abort(),e.retries++;var B=e.getOpt("chunkRetryInterval");B!==void 0?(e.pendingRetry=!0,setTimeout(e.send,B)):e.send()}};e.xhr.addEventListener("load",u,!1),e.xhr.addEventListener("error",u,!1),e.xhr.addEventListener("timeout",u,!1);var o=[["chunkNumberParameterName",e.offset+1],["chunkSizeParameterName",e.getOpt("chunkSize")],["currentChunkSizeParameterName",e.endByte-e.startByte],["totalSizeParameterName",e.fileObjSize],["typeParameterName",e.fileObjType],["identifierParameterName",e.fileObj.uniqueIdentifier],["fileNameParameterName",e.fileObj.fileName],["relativePathParameterName",e.fileObj.relativePath],["totalChunksParameterName",e.fileObj.chunks.length]].filter(function(p){return e.getOpt(p[0])}).reduce(function(p,m){return p[e.getOpt(m[0])]=m[1],p},{}),d=e.getOpt("query");typeof d=="function"&&(d=d(e.fileObj,e)),l.each(d,function(p,m){o[p]=m});var y=e.fileObj.file.slice?"slice":e.fileObj.file.mozSlice?"mozSlice":e.fileObj.file.webkitSlice?"webkitSlice":"slice",h=e.fileObj.file[y](e.startByte,e.endByte,e.getOpt("setChunkTypeFromFile")?e.fileObj.file.type:""),c=null,F=[],b=e.getOpt("parameterNamespace");if(e.getOpt("method")==="octet")c=h,l.each(o,function(p,m){F.push([encodeURIComponent(b+p),encodeURIComponent(m)].join("="))});else if(c=new FormData,l.each(o,function(p,m){c.append(b+p,m),F.push([encodeURIComponent(b+p),encodeURIComponent(m)].join("="))}),e.getOpt("chunkFormat")=="blob")c.append(b+e.getOpt("fileParameterName"),h,e.fileObj.fileName);else if(e.getOpt("chunkFormat")=="base64"){var k=new FileReader;k.onload=function(p){c.append(b+e.getOpt("fileParameterName"),k.result),e.xhr.send(c)},k.readAsDataURL(h)}var z=l.getTarget("upload",F),L=e.getOpt("uploadMethod");e.xhr.open(L,z),e.getOpt("method")==="octet"&&e.xhr.setRequestHeader("Content-Type","application/octet-stream"),e.xhr.timeout=e.getOpt("xhrTimeout"),e.xhr.withCredentials=e.getOpt("withCredentials");var T=e.getOpt("headers");typeof T=="function"&&(T=T(e.fileObj,e)),l.each(T,function(p,m){e.xhr.setRequestHeader(p,m)}),e.getOpt("chunkFormat")=="blob"&&e.xhr.send(c)},e.abort=function(){e.xhr&&e.xhr.abort(),e.xhr=null},e.status=function(){return e.pendingRetry?"uploading":e.xhr?e.xhr.readyState<4?"uploading":e.xhr.status==200||e.xhr.status==201?"success":l.contains(e.getOpt("permanentErrors"),e.xhr.status)||e.retries>=e.getOpt("maxChunkRetries")?"error":(e.abort(),"pending"):"pending"},e.message=function(){return e.xhr?e.xhr.responseText:""},e.progress=function(s){typeof s>"u"&&(s=!1);var u=s?(e.endByte-e.startByte)/e.fileObjSize:1;if(e.pendingRetry)return 0;(!e.xhr||!e.xhr.status)&&(u*=.95);var o=e.status();switch(o){case"success":case"error":return 1*u;case"pending":return 0*u;default:return e.loaded/(e.endByte-e.startByte)*u}},this}return a.uploadNextChunk=function(){var t=!1;if(a.getOpt("prioritizeFirstAndLastChunk")&&(l.each(a.files,function(i){if(i.chunks.length&&i.chunks[0].status()=="pending"&&i.chunks[0].preprocessState===0)return i.chunks[0].send(),t=!0,!1;if(i.chunks.length>1&&i.chunks[i.chunks.length-1].status()=="pending"&&i.chunks[i.chunks.length-1].preprocessState===0)return i.chunks[i.chunks.length-1].send(),t=!0,!1}),t)||(l.each(a.files,function(i){if(i.isPaused()===!1&&l.each(i.chunks,function(r){if(r.status()=="pending"&&r.preprocessState===0)return r.send(),t=!0,!1}),t)return!1}),t))return!0;var n=!1;return l.each(a.files,function(i){if(!i.isComplete())return n=!0,!1}),n||a.fire("complete"),!1},a.assignBrowse=function(t,n){typeof t.length>"u"&&(t=[t]),l.each(t,function(i){var r;i.tagName==="INPUT"&&i.type==="file"?r=i:(r=document.createElement("input"),r.setAttribute("type","file"),r.style.display="none",i.addEventListener("click",function(){r.style.opacity=0,r.style.display="block",r.focus(),r.click(),r.style.display="none"},!1),i.appendChild(r));var e=a.getOpt("maxFiles");typeof e>"u"||e!=1?r.setAttribute("multiple","multiple"):r.removeAttribute("multiple"),n?r.setAttribute("webkitdirectory","webkitdirectory"):r.removeAttribute("webkitdirectory");var f=a.getOpt("fileType");typeof f<"u"&&f.length>=1?r.setAttribute("accept",f.map(function(s){return"."+s}).join(",")):r.removeAttribute("accept"),r.addEventListener("change",function(s){x(s.target.files,s);var u=a.getOpt("clearInput");u&&(s.target.value="")},!1)})},a.assignDrop=function(t){typeof t.length>"u"&&(t=[t]),l.each(t,function(n){n.addEventListener("dragover",v,!1),n.addEventListener("dragenter",v,!1),n.addEventListener("drop",S,!1)})},a.unAssignDrop=function(t){typeof t.length>"u"&&(t=[t]),l.each(t,function(n){n.removeEventListener("dragover",v),n.removeEventListener("dragenter",v),n.removeEventListener("drop",S)})},a.isUploading=function(){var t=!1;return l.each(a.files,function(n){if(n.isUploading())return t=!0,!1}),t},a.upload=function(){if(!a.isUploading()){a.fire("uploadStart");for(var t=1;t<=a.getOpt("simultaneousUploads");t++)a.uploadNextChunk()}},a.pause=function(){l.each(a.files,function(t){t.abort()}),a.fire("pause")},a.cancel=function(){a.fire("beforeCancel");for(var t=a.files.length-1;t>=0;t--)a.files[t].cancel();a.fire("cancel")},a.progress=function(){var t=0,n=0;return l.each(a.files,function(i){t+=i.progress()*i.size,n+=i.size}),n>0?t/n:0},a.addFile=function(t,n){x([t],n)},a.addFiles=function(t,n){x(t,n)},a.removeFile=function(t){for(var n=a.files.length-1;n>=0;n--)a.files[n]===t&&a.files.splice(n,1)},a.getFromUniqueIdentifier=function(t){var n=!1;return l.each(a.files,function(i){i.uniqueIdentifier==t&&(n=i)}),n},a.getSize=function(){var t=0;return l.each(a.files,function(n){t+=n.size}),t},a.handleDropEvent=function(t){S(t)},a.handleChangeEvent=function(t){x(t.target.files,t),t.target.value=""},a.updateQuery=function(t){a.opts.query=t},this};R.exports=C})()})(I);var M=I.exports;const _=q(M),$=({handleUploadSuccess:R})=>{const C=D(),[A,a]=j.useState(!1),[l,S]=j.useState(!1),[v,N]=j.useState(null),[P,U]=j.useState(!1),O=j.useRef(null),x=async g=>{a(!1),g.opts.query.filename="hello",g.opts.query.path="thisispath",g.upload()};return j.useEffect(()=>{if(O.current){const g=new _({target:"api/audio/upload",method:"POST",query:{_token:C.props.csrf_token},fileType:[],chunkSize:1048576,headers:{Accept:"application/json"},testChunks:!1,throttleProgressCallbacks:1});g.assignBrowse(O.current),g.on("fileAdded",()=>{S(!0),x(g)}),g.on("fileProgress",w=>{window.onbeforeunload=function(){return"Dude, are you sure you want to leave? Think of the kittens!"},N(Math.floor(w.progress()*100))}),g.on("fileSuccess",async(w,t)=>{const n=JSON.parse(t);R(n),window.onbeforeunload=null,U(!0),S(!1)})}},[O]),E.jsxs("div",{className:"p-10 border-[1.9px] border-gray-400 border-dashed",children:[l&&E.jsxs("div",{style:{width:+v+"%"},className:"p-1 my-5 text-white font-semibold bg-primary transition-all duration-500 rounded-full text-center",children:[+v," %"]}),!l&&P&&E.jsxs("div",{style:{width:+v+"%"},className:"p-1 my-5 text-white font-semibold bg-green-400 transition-all duration-500 rounded-full text-center",children:[+v," %"]}),l||!P&&E.jsx("p",{className:"cursor-pointer text-center",ref:O,children:"Browse File"})]})};export{$ as A};
